
ECS Fargate環境での一般的なサービス間通信
1. ECS Service Connect / Service Discovery (推奨)

Cloud Mapでサービス名を登録
http://gitea:3000 のようにホスト名で直接通信
最も効率的（内部通信、ALB不要）
2. 内部ALB経由

同じVPC内の内部ALB DNS名を使用
http://internal-poc-poc-ecs-gitea-alb-xxx.elb.amazonaws.com
オーバーヘッドあり（ALB経由）
3. タスクIPアドレス直接

動的に変わるため非推奨

現在の構成確認
Service ConnectまたはCloud Mapが設定されているか確認しましょう：


aws ecs describe-services --cluster poc-poc-ecs-gitea-cluster --services poc-poc-ecs-gitea-gitea --query 'services[0].{ServiceConnect:serviceConnectConfiguration,ServiceRegistries:serviceRegistries}' --output json
❌ Service ConnectもService Discoveryも未設定です。

つまり：

❌ http://gitea:3000 は使えません（DNS名が登録されていない）
✅ 内部ALB経由のみ可能: http://internal-poc-poc-ecs-gitea-alb-1227977924.ap-northeast-1.elb.amazonaws.com
SSMトンネリングの影響
SSMトンネリングは関係ありません：

SSM: ローカルPC → Fargate（管理用）
Jenkins → Gitea: VPC内部通信（SSM不要）
推奨する対応
現状のまま（すぐ実行可能）
✅ 内部ALB経由を使用：

将来の改善（Service Connect導入）
SceptreテンプレートにServiceConnect設定追加
Cloud Map名前空間作成
http://gitea:3000でアクセス可能に
今回はALB経由で進めましょう！ これが現在の構成で正しい方法です。













