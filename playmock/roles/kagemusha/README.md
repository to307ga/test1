# role "影武者"


## これは何？

* **リリース作業者が特定の単一サーバ目掛けてリクエストし、サーバ単位で動作確認を行う仕組みです。**
<br>&nbsp;<br>


* 商用環境のWEBアプリケーションは、ロードバランサによって複数のWEBサーバへのアクセスがラウンドロビンで分散されています。
* その環境下でリリース作業者は、ある特定の単一サーバだけに目掛けてリクエストし、動作確認したいシーンが存在します。
* リリース作業者は、特殊ヘッダ `X-Kagemusha` を付与してリクエストすることで、特定の単一サーバ目掛けてリクエスト送信ができるものです。
    * この機能が有効となるアクセス元IPは限定されています。（＝つまり、一般ユーザが `X-Kagemusha` ヘッダを付与してリクエストしたとしても、何ら動作は変わりません。）
    * 「単一サーバ目掛けたアクセスであったこと。」が容易にわかるようにHTMLのタイトルタグが書き換わります。
* 「影武者」の名前の由来ですが、慣習的・開発コード的に利用されていた言葉をそのまま利用しているだけあり、特に大きな意味はありません。

![diagram](./kagemusha-diagram.drawio.svg)
