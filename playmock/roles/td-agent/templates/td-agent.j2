
<system>
  # log_level debug
  log_level info
  # log_level error
  workers {{td_agent_workers}}
</system>

# <source>
  # @type forward
  # port 24224
  # bind 0.0.0.0
# </source>

{% for i in range(0,td_agent_workers) %} 
<worker {{ i }}>
#<worker {{ loop.index0 }}>
  <source>
    @type forward
    # port {{ loop.index0 + 24224 }}
    port {{ 24224 + i }}
    bind 0.0.0.0
  </source>
</worker>
{% endfor %}

# monitor agent settings
# <source>
  # @type monitor_agent
  # bind 0.0.0.0
  # port 24220
# </source>

# 外部から来たログは全て対象。ロール名をレコードに追加する
#<filter {goo*,id*}.**>
#  @type record_transformer
#  enable_ruby
#  <record>
#    host_groups_name ${tag_parts[0].split(/-[0-9]{3}$/)[0]}
#  </record>
#  <buffer tag>
#  </buffer>
#</filter>

@include /etc/td-agent/config.d/*/*.conf

#<match **>
#  @type null
#</match>
